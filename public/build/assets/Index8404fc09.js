import{k as m,K as U,G as q,T as z,o as W,m as n,n as c,p as s,u as t,w as i,ae as H,Z as J,s as e,t as B,B as u,x as X,y as Y,v as p,z as b,D as ee,A as re,a8 as te,C as se,O as v}from"./vendorb2c7101c.js";import{_ as oe}from"./AuthenticatedLayout4b68b4d2.js";import{Q as ae,Z as N,d as le}from"./flowbite-vue4519d4b7.js";import{S as T}from"./sweetalert2.all5300f0ca.js";import{_ as f}from"./InputErrorb5789600.js";import{_ as x}from"./InputLabel949fdd54.js";import{_ as de}from"./PrimaryButton2bb40203.js";import{_ as D}from"./TextInput70c275a9.js";import{s as ne}from"./multiselect2742171c.js";import{P as A}from"./datatables.net-vue3929798cd.js";import{D as ie,l as ce}from"./es-ESeb942a1a.js";const ue={class:"ml-4 col-span-full"},pe={class:"px-5 col-span-full flex justify-between items-center"},ge=e("h1",{class:"text-xl font-semibold text-gray-900 sm:text-2xl dark:text-white"},"Usuarios",-1),me={class:"p-4 mb-4 bg-white col-span-12 border border-gray-200 rounded-lg shadow-sm 2xl:col-span-12 dark:border-gray-700 sm:p-4 dark:bg-gray-800"},be={class:"overflow-x-auto"},fe={class:"lg:inline-block min-w-full mt-4"},xe=e("thead",{class:"text-md text-center text-gray-700 bg-gray-200/80 dark:bg-gray-700 dark:text-gray-400"},[e("tr",null,[e("th",{scope:"col",class:"p-1 border border-gray-300 dark:border-gray-500"}," ID "),e("th",{scope:"col",class:"p-1 border border-gray-300 dark:border-gray-500"}," Nombre "),e("th",{scope:"col",class:"p-1 border border-gray-300 dark:border-gray-500"},[e("div",{class:"flex justify-center"}," Usuario ")]),e("th",{scope:"col",class:"p-1 border border-gray-300 dark:border-gray-500"},[e("div",{class:"flex justify-center"}," Foto ")]),e("th",{scope:"col",class:"p-1 border border-gray-300 dark:border-gray-500"},[e("div",{class:"flex justify-center"}," Perfil ")]),e("th",{scope:"col",class:"p-1 border border-gray-300 dark:border-gray-500"},[e("div",{class:"flex justify-center"}," Estado ")]),e("th",{scope:"col",class:"p-1 border border-gray-300 dark:border-gray-500"},[e("div",{class:"flex justify-center"}," Último login ")]),e("th",{scope:"col",class:"p-1 border border-gray-300 dark:border-gray-500"},[e("div",{class:"flex justify-center"}," Acciones ")])])],-1),_e={scope:"row",class:"p-1 border dark:bg-gray-800 dark:border-gray-700 font-medium text-gray-900 dark:text-white"},ye={scope:"row",class:"p-1 border dark:bg-gray-800 dark:border-gray-700 font-medium text-gray-900 dark:text-white"},he={scope:"row",class:"p-1 border dark:border-gray-700"},ve={scope:"row",class:"p-1 border dark:border-gray-700"},ke=["src"],we={scope:"row",class:"p-1 border dark:border-gray-700"},Ce={scope:"row",class:"p-1 border dark:border-gray-700"},Se=["onClick"],Ve=["onClick"],Ue={scope:"row",class:"p-1 border dark:border-gray-700"},Be={class:"px-4 py-2 text-right border dark:border-gray-700"},De={key:0,class:"inline-block rounded bg-blue-600 px-2 py-1 text-base font-semibold text-white mr-1 mb-1 hover:bg-blue-700"},$e=["onClick"],je=e("i",{class:"fas fa-edit"},null,-1),Ee=[je],Ie={key:1,class:"inline-block rounded bg-red-600 px-2 py-1 text-base font-semibold text-white mr-1 mb-1 hover:bg-red-700"},Fe=["onClick"],ze=e("i",{class:"fas fa-trash-alt"},null,-1),Ne=[ze],Te={class:"z-40"},Ae={class:"flex items-center m-0 text-lg font-bold text-gray-900 dark:text-gray-400"},Me=["onSubmit"],Pe={class:"px-2 grid grid-cols-6 gap-4 md:gap-2 2xl:gap-6"},Oe={class:"col-span-6 shadow-default xl:col-span-3"},Ze={class:"col-span-6 shadow-default xl:col-span-3"},Ge={class:"col-span-6 shadow-default xl:col-span-3"},Ke={class:"col-span-6 shadow-default xl:col-span-3"},Le={class:"col-span-6 xl:col-span-6"},Qe=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-300",id:"file_input_help"},"Peso máximo de la foto 2MB",-1),Re={class:"flex justify-between pt-0"},dr={__name:"Index",setup(qe){A.use(ie);const _=m("/images/usuarios/user.png"),g=m(!1),k=m(""),w=m(null),{permissions:C}=U().props.auth,M=q(()=>U().props.usuarios.data),P=z({id:""}),$=m({value:"",closeOnSelect:!0,placeholder:"Seleccione",searchable:!0,options:[]});W(()=>{$.value.options=U().props.lista_roles});const r=z({id:"",name:"",username:"",photo:"",password:"",perfil:""}),O=()=>{r.clearErrors(),w.value==1?r.post(route("usuarios.store"),{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{g.value=!1,S("Usuario Creado"),v.get(route("usuarios.index"))},onFinish:()=>{},onError:()=>{}}):r.post(route("usuarios.update",r.id),{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{g.value=!1,S("Usuario actualizado"),v.get(route("usuarios.index"))},onError:()=>{}})};function j(){g.value=!1}function E(l,a,o,d,y,h){g.value=!0,w.value=l,r.perfil=h,r.name="",r.username="",r.password="",r.photo="",_.value="/images/usuarios/user.png",w.value=="1"?(k.value="Agregar",r.perfil=""):(_.value=y,k.value="Editar",r.id=a,r.name=o,r.username=d)}const Z=l=>{l.preventDefault(),r.photo=l.target.files[0];let a=l.target.files;if(a&&a[0]){let o=new FileReader;o.onload=d=>{_.value=d.target.result},o.readAsDataURL(a[0])}},G=(l,a)=>{T.mixin({buttonsStyling:!0}).fire({width:350,title:"Seguro de eliminar "+a,text:"Se eliminará definitivamente",icon:"question",showCancelButton:!0,confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",cancelButtonColor:"red",confirmButtonColor:"#2563EB"}).then(d=>{d.isConfirmed&&P.delete(route("usuarios.destroy",l),{preserveScroll:!0,onSuccess:()=>{S("Eliminado"),v.get(route("usuarios.index"))}})})},S=l=>{r.reset(),T.fire({width:350,title:l,icon:"success"})},I=(l,a)=>{v.get("/usuario/status/"+l+"/"+a,{preserveState:!0})},K=l=>{l.target.value=l.target.value.replace(/[^a-z0-9]/gi,""),l.target.value=(""+l.target.value).replace(/\s+/g,"")};return(l,a)=>(n(),c("div",null,[s(t(J),{title:"Usuarios"}),s(oe,null,{default:i(()=>[e("div",ue,[s(t(ae),null,{default:i(()=>[s(t(N),{href:"/",home:""},{default:i(()=>[B(" Inicio ")]),_:1}),s(t(N),null,{default:i(()=>[B(" Usuarios ")]),_:1})]),_:1})]),e("div",pe,[ge,t(C).includes("crear-usuarios")?(n(),c("button",{key:0,type:"button",onClick:a[0]||(a[0]=o=>E(1)),class:"m-1 p-2 text-sm font-medium rounded text-center text-white bg-green-500 hover:bg-green-600 dark:bg-green-500 dark:hover:bg-green-700"}," Agregar Usuario ")):u("",!0)]),e("div",me,[e("div",be,[e("div",fe,[s(t(A),{options:{language:t(ce)},class:"pt-3 w-full text-sm text-center text-gray-600 dark:text-gray-400"},{default:i(()=>[xe,e("tbody",null,[(n(!0),c(X,null,Y(M.value,({id:o,name:d,username:y,photo:h,roles:L,status:F,last_login_at:Q,id_rol:R},We)=>(n(),c("tr",{key:o,class:"bg-white border-b dark:bg-gray-800 dark:border-gray-700"},[e("th",_e,p(o),1),e("th",ye,p(d),1),e("td",he,p(y),1),e("td",ve,[e("img",{class:"rounded-full shadow-2xl border-4 w-10 h-10 object-contain",src:h,alt:"image description"},null,8,ke)]),e("td",we,p(L),1),e("td",Ce,[F==1?(n(),c("button",{key:0,type:"button",onClick:b(V=>I(o,0),["prevent"]),class:"p-1 text-xs font-medium rounded text-center text-white bg-green-500 hover:bg-green-600 dark:bg-green-500 dark:hover:bg-green-700"},"Activado",8,Se)):u("",!0),F==0?(n(),c("button",{key:1,type:"button",onClick:b(V=>I(o,1),["prevent"]),class:"p-1 text-xs font-medium rounded text-center text-white bg-red-500 hover:bg-red-600 dark:bg-red-500 dark:hover:bg-red-700"},"Desactivado",8,Ve)):u("",!0)]),e("td",Ue,p(Q),1),e("td",Be,[t(C).includes("editar-usuarios")?(n(),c("span",De,[e("button",{onClick:b(V=>E(2,o,d,y,h,R),["prevent"])},Ee,8,$e)])):u("",!0),t(C).includes("eliminar-usuarios")?(n(),c("span",Ie,[e("button",{onClick:b(V=>G(o,d),["prevent"])},Ne,8,Fe)])):u("",!0)])]))),128))])]),_:1},8,["options"])])])])]),_:1}),s(H,null,{default:i(()=>[e("div",Te,[g.value?(n(),ee(t(le),{key:0,size:"xl",onClose:j},{header:i(()=>[e("div",Ae,p(k.value),1)]),body:i(()=>[e("form",{onSubmit:b(O,["prevent"])},[e("div",Pe,[e("div",Oe,[s(x,{for:"name",value:"Nombre",class:"block text-base font-medium leading-6 text-gray-900"}),s(D,{id:"name",type:"text",modelValue:t(r).name,"onUpdate:modelValue":a[1]||(a[1]=o=>t(r).name=o),autocomplete:"name",placeholder:"Ingrese Nombre"},null,8,["modelValue"]),s(f,{class:"mt-1 text-xs",message:t(r).errors.name},null,8,["message"])]),e("div",Ze,[s(x,{for:"username",value:"Usuario",class:"block text-base font-medium leading-6 text-gray-900"}),s(D,{id:"username",type:"text",onKeyup:K,modelValue:t(r).username,"onUpdate:modelValue":a[2]||(a[2]=o=>t(r).username=o),autocomplete:"username",placeholder:"Ingrese usuario"},null,8,["modelValue"]),s(f,{class:"mt-1 text-xs",message:t(r).errors.username},null,8,["message"])]),e("div",Ge,[s(x,{for:"password",value:"Contraseña",class:"block text-base font-medium leading-6 text-gray-900"}),s(D,{id:"password",type:"password",modelValue:t(r).password,"onUpdate:modelValue":a[3]||(a[3]=o=>t(r).password=o),placeholder:"Ingrese Contraseña",class:"block w-full text-gray-900 border border-gray-300 rounded bg-gray-50 sm:text-base focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"},null,8,["modelValue"]),s(f,{class:"mt-1 text-xs",message:t(r).errors.password},null,8,["message"])]),e("div",Ke,[s(x,{for:"perfil",value:"Perfil",class:"block text-base font-medium leading-6 text-gray-900"}),s(t(ne),re({id:"perfil",modelValue:t(r).perfil,"onUpdate:modelValue":a[4]||(a[4]=o=>t(r).perfil=o)},$.value),null,16,["modelValue"]),s(f,{class:"mt-1 text-xs",message:t(r).errors.perfil},null,8,["message"])]),e("div",Le,[s(x,{for:"foto",value:"Subir Foto",class:"block mb-0 text-base font-medium leading-6 text-gray-900"}),e("input",{onInput:Z,class:"block w-full text-xs text-gray-900 border border-gray-300 rounded cursor-pointer bg-gray-50 dark:text-gray-400 focus:outline-none dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400","aria-describedby":"file_input_help",id:"file_input",type:"file"},null,32),Qe,s(f,{class:"mt-1 text-xs",message:t(r).errors.photo},null,8,["message"]),e("div",{class:"imagePreviewWrapper",style:te({"background-image":`url(${_.value})`})},null,4)])]),e("div",Re,[e("button",{onClick:j,type:"button",class:"inline-block rounded bg-red-600 p-2 text-sm font-semibold text-white mr-1 mb-1 hover:bg-red-700"}," Cancelar "),s(de,{class:se(["inline-block rounded bg-blue-600 p-2 text-sm font-semibold text-white mr-1 mb-1 hover:bg-blue-700",{"opacity-50":t(r).processing}]),disabled:t(r).processing},{default:i(()=>[B(" Guardar ")]),_:1},8,["class","disabled"])])],40,Me)]),_:1})):u("",!0)])]),_:1})]))}};export{dr as default};
