import{k as c,K as R,T as V,m as u,n as p,s as a,p as d,w as b,v as m,z as B,t as v,u as o,x as D,y as F,M as N,an as j,C as z,a as I,O}from"./vendorb2c7101c.js";import{_ as T}from"./InputErrorb5789600.js";import{_ as G}from"./InputLabel949fdd54.js";import{_ as K}from"./Modal5c7d7f4d.js";import{_ as L}from"./PrimaryButton2bb40203.js";import{S as h}from"./sweetalert2.all5300f0ca.js";import"./multiselect2742171c.js";const U={class:"p-2"},W=["onSubmit"],q={class:"px-2 grid grid-cols-6 gap-4 md:gap-3 2xl:gap-6 mb-2"},H={class:"col-span-6 shadow-default xl:col-span-6"},J={class:"col-span-6 shadow-default xl:col-span-6"},P=a("hr",{class:"p-2"},null,-1),Q={class:"grid grid-cols-3 gap-4"},X=["id","value","onChange"],Y=["for"],Z={class:"flex justify-end pt-2"},x="Colonia",_="pedidos",ne={__name:"AsignarRepartidor",props:{categoriaId:{default:""}},setup(w){const y=w,r=c(!1),{user:C}=R().props.auth,e=V({id:"",ruta_id:"",repartidor_id:"",responsable_id:"",colonia:"",cantidad_rutas:""}),k=c({value:""}),f=c({value:""}),S=()=>{A(y.categoriaId)},A=t=>{I.get(route(_+".asignarindividual",t)).then(i=>{r.value=!0;var s=i.data;k.value=s.rutas,f.value=s.repartidores,console.log(s.repartidores),e.id=s.envio.id,e.responsable_id=C.id,e.colonia=s.envio.colonia;const n=s.rutas.find(l=>l.label===s.envio.colonia);n&&(e.ruta_id=n.value)})},g=()=>{r.value=!1,e.reset()},E=t=>{e.cantidad_rutas=t},M=()=>{e.clearErrors(),e.cantidad_rutas>=3?h.fire({icon:"warning",title:"Este repartidor ya tiene 3 o mas rutas asignadas, debe seleccionar otro.",width:350}):e.post(route(_+".update",e.id),{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{r.value=!1,$(x+" Asignada"),O.get(route(_+".index")),e.reset()},onFinish:()=>{},onError:()=>{}})},$=t=>{e.reset(),h.fire({width:350,title:t,icon:"success"})};return(t,i)=>(u(),p("div",null,[a("button",{type:"button",class:"rounded bg-green-500 px-1 py-1 text-xs font-normal text-white mr-1 mb-1 hover:bg-green-700",onClick:S},"Asignar"),d(K,{show:r.value,onClose:g,maxWidth:"md"},{default:b(()=>[a("div",U,[a("div",{class:"p-4 mb-4 rounded-t flex justify-between items-center border-b border-gray-200 dark:border-gray-600"},[a("h2",{class:"text-lg font-medium text-gray-900"}," Asignar "+m(x))]),a("form",{onSubmit:B(M,["prevent"])},[a("div",q,[a("div",H,[v(" Colonia: "),a("small",null,m(o(e).colonia),1)]),a("div",J,[P,d(G,{value:"Repartidor",class:"block text-base font-medium leading-6 text-gray-900"}),a("div",Q,[(u(!0),p(D,null,F(f.value,(s,n)=>(u(),p("div",{key:n,class:"flex items-center space-x-2"},[N(a("input",{type:"radio",id:"repartidor_"+s.value,"onUpdate:modelValue":i[0]||(i[0]=l=>o(e).repartidor_id=l),value:s.value,onChange:l=>E(s.cantidad_rutas)},null,40,X),[[j,o(e).repartidor_id]]),a("label",{for:"repartidor_"+s.value},m(s.label),9,Y)]))),128))]),d(T,{class:"mt-1 text-xs",message:o(e).errors.repartidor_id},null,8,["message"])])]),a("div",Z,[a("button",{onClick:g,type:"button",class:"inline-block rounded bg-red-600 p-2 text-sm font-semibold text-white mr-4 mb-1 hover:bg-red-700"}," Cancelar "),d(L,{class:z(["inline-block rounded bg-blue-600 p-2 text-sm font-semibold text-white mr-1 mb-1 hover:bg-blue-700",{"opacity-50":o(e).processing}]),disabled:o(e).processing},{default:b(()=>[v(" Guardar ")]),_:1},8,["class","disabled"])])],40,W)])]),_:1},8,["show"])]))}};export{ne as default};
